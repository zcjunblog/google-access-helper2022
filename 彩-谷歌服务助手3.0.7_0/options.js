(()=>{"use strict";var e,t;!function(e){e[e.NULL=1]="NULL",e[e.INIT=2]="INIT",e[e.CONNECTING=3]="CONNECTING",e[e.LOGINING=4]="LOGINING",e[e.CHECKING=5]="CHECKING",e[e.PROXYING=6]="PROXYING",e[e.RUNNING=7]="RUNNING",e[e.INIT_CONNECT_ERROR=8]="INIT_CONNECT_ERROR",e[e.INIT_CONFIG_ERROR=9]="INIT_CONFIG_ERROR",e[e.NEED_LOGIN_ERROR=10]="NEED_LOGIN_ERROR",e[e.CHECKING_HOME_ERROR=11]="CHECKING_HOME_ERROR",e[e.EXPIRE_HOME_ERROR=12]="EXPIRE_HOME_ERROR",e[e.SERVER_INTERNAL_ERROR=13]="SERVER_INTERNAL_ERROR",e[e.PROXY_CONFLICT_ERROR=14]="PROXY_CONFLICT_ERROR",e[e.PROXY_BANNED_ERROR=15]="PROXY_BANNED_ERROR"}(e||(e={})),function(e){e.NOT_CONTROLLABLE="not_controllable",e.OTHER_EXTENSION="controlled_by_other_extensions",e.AVAILABLE="controllable_by_this_extension",e.CONTROLLING="controlled_by_this_extension"}(t||(t={})),localStorage.mode;const s=chrome,n=(s.webRequest.onBeforeRequest,s.runtime),o=(s.browserAction,s.proxy.settings,s.i18n.getMessage);s.tabs,s.windows,s.notifications,n.getManifest().version,o("@@extension_id");let i=!1,a=!1;n.onInstalled.addListener((e=>{"install"==e.reason&&(i=!0,a=!0)}));const r=e=>{let t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),s=window.location.search.substr(1).match(t);return null!=s?decodeURIComponent(s[2]):null},l=function(e){"string"==typeof e&&(this.value=Array.prototype.slice.call(document.querySelectorAll(e))),"object"==typeof e&&(this.value=[e])};l.prototype={eq:function(e){return this.value=[this.value[e]],this},each:function(e){return[].forEach.call(this.value,e),this},css:function(e){return this.each((function(t){t.style.cssText=t.style.cssText+e}))},cssdom:function(e){return this.each((function(t){for(var s in e)t.style[s]=e[s]}))},attr:function(e,t){return this.each((function(s){s.setAttribute(e,t)}))},getAttr:function(e){return this.value[0].getAttribute(e)},removeAttr:function(e){return this.each((function(t){t.removeAttribute(e)}))},animate:function(e,t,s,n,o,i,a,r,l,c){return this.each((function(d){d.style.cssText=d.style.cssText+"transition: all "+e+"s ease-in-out; transform: scale("+t+") rotate("+s+"deg) rotateX("+n+"deg) rotateY("+o+"deg) translate("+i+"px, "+a+"px) skew("+r+"deg, "+l+"deg); opacity:"+c+";"}))},on:function(e,t){return this.each((function(s){s.addEventListener(e,t,!1)}))},addClass:function(e){var t=e.split(" ");return this.each((function(e){for(var s=0;s<t.length;s++)e.classList?e.classList.add(t[s]):e.className+=" "+t[s]}))},toggleClass:function(e){var t=e.split(" ");return this.each((function(e){for(var s=0;s<t.length;s++)e.classList?e.classList.toggle(t[s]):new RegExp("\\b"+t[s]+"\\b").test(e.className)?e.className=e.className.replace(new RegExp("\\b"+t[s]+"\\b","g"),""):e.className+=" "+t[s]}))},removeClass:function(e){var t=e.split(" ");return this.each((function(e){for(var s=0;s<t.length;s++)e.classList?e.classList.remove(t[s]):e.className=e.className.replace(new RegExp("\\b"+t[s]+"\\b","g"),"")}))},html:function(e){return void 0===e?this.value[0].innerHTML:this.each((function(t){t.innerHTML=e}))},text:function(e){return void 0===e?this.value[0].innerText||this.value[0].textContent:this.each((function(t){t.innerText=e,t.textContent=e}))},insertBefore:function(e){return this.each((function(t){t.insertAdjacentHTML("beforeBegin",e)}))},insertAfter:function(e){return this.each((function(t){t.insertAdjacentHTML("afterEnd",e)}))},insertFirst:function(e){return this.each((function(t){t.insertAdjacentHTML("afterBegin",e)}))},insertLast:function(e){return this.each((function(t){t.insertAdjacentHTML("beforeEnd",e)}))},replaceChild:function(e,t){return console.log(this.value[0].parentNode),this.each((function(s){s.parentNode.replaceChild(e,t)}))},empty:function(){return this.each((function(e){e.innerHTML=""}))},parent:function(){return c(this.value[0].parentNode)},children:function(){return this.value=Array.prototype.filter.call(this.value[0].childNodes,(e=>e.nodeType<2)),this},first:function(){return c(this.value[0].children[0])},last:function(){return c(this.value[0].children[this.value[0].children.length-1])},prev:function(){return c(this.value[0].previousSibling.previousSibling)},siblings:function(){return this.value=Array.prototype.filter.call(this.value[0].parentNode.children,(e=>e!==this.value[0])),this},next:function(){return c(this.value[0].nextSibling.nextSibling)},get:function(){return this.value[0]},offset:function(){return this.each((function(e){offset=e.getBoundingClientRect()}))},log:function(){console.log(this)}};const c=function(e){return new l(e)},d=(()=>{const e={type:"default",duration:3};let t,s=0;const n={defaults:"",info:'<svg t="1620460830700" class="prefix-icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="19805" width="18" height="18"><path d="M512 128a384 384 0 1 0 0 768 384 384 0 0 0 0-768z m0 707.669333a323.669333 323.669333 0 1 1 0-647.338666 323.669333 323.669333 0 0 1 0 647.338666z m-0.085333-248.106666c5.034667-12.245333 12.16-29.866667 21.333333-52.906667 9.216-23.04 16.682667-42.496 22.485333-58.368 5.802667-15.872 8.704-26.197333 8.704-30.976 0-8.106667-5.162667-12.16-15.488-12.16-11.861333 0-29.354667 6.656-52.565333 19.968-23.168 13.312-48.213333 31.402667-75.221333 54.272l13.994666 12.8 10.24-8.405333c6.272-6.016 13.824-11.690667 22.656-16.981334 8.832-5.290667 15.146667-7.936 18.944-7.936 5.290667 0 7.936 2.56 7.936 7.765334 0 1.450667-6.954667 19.626667-20.821333 54.485333-13.866667 34.858667-21.674667 54.698667-23.466667 59.434667l-27.989333 64.426666c-7.296 18.688-10.965333 32.085333-10.965333 40.192 0 5.376 2.133333 9.813333 6.442666 13.354667 4.266667 3.541333 9.216 5.290667 14.762667 5.290667 13.866667 0 33.536-7.253333 58.965333-21.674667 25.472-14.464 49.664-30.72 72.533334-48.810667l-14.677334-13.44-5.248 3.285334a72.533333 72.533333 0 0 1-5.674666 3.285333c-24.96 17.834667-42.24 26.752-51.797334 26.752-5.077333 0-7.594667-2.56-7.594666-7.765333 0-4.138667 3.797333-15.957333 11.349333-35.498667 7.552-19.498667 14.592-36.266667 21.162667-50.389333zM560.981333 298.666667c-9.258667 0-17.664 2.517333-25.173333 7.552a55.466667 55.466667 0 0 0-17.493333 18.346666c-4.266667 7.253333-6.314667 14.933333-6.314667 23.04 0 9.301333 3.456 17.706667 10.410667 25.173334a32.981333 32.981333 0 0 0 25.088 11.221333c13.013333 0 24.576-5.546667 34.688-16.554667 10.069333-11.008 15.146667-22.912 15.146666-35.669333a30.208 30.208 0 0 0-10.837333-23.552 37.376 37.376 0 0 0-25.557333-9.557333z" p-id="19806" fill="#2db7f5"></path></svg>',success:'<svg t="1620640616886" class="prefix-icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="20843" width="18" height="18"><path d="M512 39.384615C250.092308 39.384615 39.384615 250.092308 39.384615 512s210.707692 472.615385 472.615385 472.615385 472.615385-210.707692 472.615385-472.615385S773.907692 39.384615 512 39.384615z m263.876923 354.461539L474.584615 699.076923c-11.815385 11.815385-31.507692 11.815385-43.323077 0L265.846154 531.692308c-11.815385-11.815385-11.815385-31.507692 0-43.323077l43.323077-43.323077c11.815385-11.815385 31.507692-11.815385 43.323077 0l86.646154 88.615384c7.876923 7.876923 21.661538 7.876923 29.538461 0L689.230769 305.230769c11.815385-11.815385 31.507692-11.815385 43.323077 0l43.323077 43.323077c13.784615 11.815385 13.784615 31.507692 0 45.292308z" p-id="20844" fill="#19be6b"></path></svg>',warning:'<svg t="1620640668390" class="prefix-icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="21700" width="18" height="18"><path d="M512 64C264.64 64 64 264.64 64 512c0 247.424 200.64 448 448 448 247.488 0 448-200.576 448-448C960 264.64 759.488 64 512 64zM512 768c-26.432 0-48-21.504-48-48S485.568 672 512 672c26.624 0 48 21.504 48 48S538.624 768 512 768zM560 528C560 554.56 538.624 576 512 576 485.568 576 464 554.56 464 528l0-224C464 277.44 485.568 256 512 256c26.624 0 48 21.44 48 48L560 528z" p-id="21701" fill="#ff9900"></path></svg>',error:'<svg t="1620640709781" class="prefix-icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="22548" width="18" height="18"><path d="M512 64.303538c-247.25636 0-447.696462 200.440102-447.696462 447.696462 0 247.254314 200.440102 447.696462 447.696462 447.696462s447.696462-200.440102 447.696462-447.696462S759.25636 64.303538 512 64.303538zM710.491727 665.266709c12.491499 12.491499 12.489452 32.729425-0.002047 45.220924-6.246261 6.246261-14.429641 9.370415-22.611997 9.370415s-16.363689-3.121084-22.60995-9.366322L512 557.222971 358.730221 710.491727c-6.246261 6.246261-14.429641 9.366322-22.611997 9.366322s-16.365736-3.125177-22.611997-9.370415c-12.491499-12.491499-12.491499-32.729425 0-45.220924l153.268756-153.266709L313.50725 358.730221c-12.491499-12.491499-12.489452-32.729425 0.002047-45.220924s32.729425-12.495592 45.220924-0.004093l153.268756 153.268756 153.268756-153.268756c12.491499-12.491499 32.729425-12.487406 45.220924 0.004093s12.493545 32.729425 0.002047 45.220924L557.225017 512 710.491727 665.266709z" p-id="22549" fill="#ed4014"></path></svg>',loading:'<svg t="1620640906619" class="prefix-icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="26555" width="18" height="18"><path d="M512 512m-426.666667 0a426.666667 426.666667 0 1 0 853.333334 0 426.666667 426.666667 0 1 0-853.333334 0Z" fill="#959BA7" fill-opacity=".3" p-id="26556"></path><path d="M938.666667 512c0-235.648-191.018667-426.666667-426.666667-426.666667v426.666667h426.666667z" fill="#2db7f5" p-id="26557" data-spm-anchor-id="a313x.7781069.0.i75" class="selected"></path><path d="M512 512m-320 0a320 320 0 1 0 640 0 320 320 0 1 0-640 0Z" fill="#FFFFFF" p-id="26558"></path></svg>',closable:'<svg t="1620705561796" class="suffix-icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="28642" width="18" height="18"><path d="M512 426.45429624L683.09140753 255.3628887c24.44162965-24.44162965 61.10407412-24.44162965 85.54570377 0s24.44162965 61.10407412 0 85.54570377L597.54570376 512l171.09140754 171.09140753c24.44162965 24.44162965 24.44162965 61.10407412 0 85.54570377s-61.10407412 24.44162965-85.54570377 0L512 597.54570376 340.90859247 768.6371113c-24.44162965 24.44162965-61.10407412 24.44162965-85.54570377 0-24.44162965-24.44162965-24.44162965-61.10407412 0-85.54570377L426.45429624 512 255.3628887 340.90859247C230.92125905 316.46696281 230.92125905 279.80451835 255.3628887 255.3628887c24.44162965-24.44162965 61.10407412-24.44162965 85.54570377 0L512 426.45429624z" fill="#808695" p-id="28643"></path></svg>'};function o(){return t=t||(()=>{let e=document.getElementById("messages");if(!e){let t=document.createElement("div");t.id="messages",t.setAttribute("messages","messages"),e=document.body.appendChild(t)}return{rootHtml:e,notice(e){return this.rootHtml.appendChild(function(e){const t=document.createElement("template");return e=e.trim(),t.innerHTML=e,t.content.firstChild}(e.html)),this.remove(e),delete e.html,e},remove(e){let t=document.getElementById(e.id);function s(){t.classList.add("notice-fade"),setTimeout((()=>{t.remove()}),350)}e.closable&&(document.getElementById(e.id).getElementsByClassName("suffix-icon")[0].onclick=e=>{s()}),0===e.duration?e.html||s():setTimeout(s,1e3*e.duration)},destroy(){this.rootHtml.classList.add("messages-fade"),setTimeout((()=>{this.rootHtml.remove()}),3e3)}}})(),t}return{info(e){return this.message("info",e)},success(e){return this.message("success",e)},warning(e){return this.message("warning",e)},error(e){return this.message("error",e)},loading(e){return this.message("loading",e)},loadingM(e){return this.message("loadingM",e)},message:(t,i)=>("string"==typeof i&&(i={content:i}),function(t="",i=e.duration,a=e.type,r=function(){},l=!1){const c=n["loadingM"===a?"loading":a],d="loading"===a||"loadingM"===a?" load-loop":"",u="loadingM"===a?'<div class="div-curtain"></div>':"";let m=o();return s++,m.notice({id:`message_key_${s}`,duration:i,html:`\n                <div id="message_key_${s}"  class="notice" style="z-index:${100+s}">\n                    <div class="message ${c?"prefix":""} ${l?"suffix":""} message-${a} ${d} " top="50px">\n                        ${c}\n                        <span>${t}</span>\n                        ${l?n.closable:""}\n                    </div>\n                    ${u}\n                </div>`,content:t,onClose:r,closable:l,type:a})}(i.content,i.duration,t,i.onClose,i.closable)),config(t){t.type&&/^default|info|warning|success|error|loading$/.test(t.type)&&(e.type=t.type),(t.duration||0===t.duration)&&(e.duration=t.duration)},remove(e){o().remove(e)},destroy(){let e=o();t=null,e.destroy()}}})();window.addEventListener("load",(()=>{var e;chrome.runtime.sendMessage({cmd:"option"},(s=>{e=s,t()}));const t=()=>{switch(c(".view-box").addClass("conceal"),r("type")){case"welcome":c("#welcome-view").removeClass("conceal"),"true"==r("isreg")?c("#welcome-view .last-recommend .welcome-talk").text(chrome.i18n.getMessage("optionsWelcomePageContent4")):c("#welcome-view .last-recommend .welcome-talk").text(chrome.i18n.getMessage("optionsWelcomePageContent5"));break;case"active":c("#active-view").removeClass("conceal"),c("#course-iframe").attr("src",e.guideHelp),e.tips&&c(".active-view-prompt").removeClass("conceal"),e.guideHeight&&c("course-iframe").attr("style","height:"+e.guideHeight+"px");break;case"login":c("a[data-skip='tos']").attr("href",e.tos),c("a[data-skip='privacy']").attr("href",e.privacy),c("#login-form").removeClass("conceal"),c("#form-box").removeClass("conceal");break;default:e.email?(c("#info-view").removeClass("conceal"),c(".login-email").html(e.email),c("#info-view .nickname").text(e.nick),e.autoGuide&&(c("#auto-open-home").attr("checked","true"),c(".radio-box ").removeClass("conceal"))):window.location.href="/options.html?type=login"}},s=(e,t)=>{if(!e||"string"!=typeof e)return!1;if(!t||"string"!=typeof t)return!1;let s=e.indexOf(t),n=e[s-1],o=e[s+t.length];return!(-1===s||" "!==n&&void 0!==n||" "!==o&&void 0!==o)},n=e=>{let t=e.target.value,s=e.target.nextElementSibling,n={value:t,status:!0},o={status:!1};if(!s)return n;let i=[],a=[];try{i=c(s).getAttr("RegExp").split("&&"),a=c(s).getAttr("RegExpValues").split("&&")}catch(t){return console.warn(`input#${e.target.id}：Property: RegExp or RegExpValues is empty.`),n}for(let r=0;r<i.length;r++){let l=new RegExp(i[r]),d=a[r];if(!l.test(t))return c(e.target.parentNode).addClass("form-item-error"),c(s).text(d),o.value=d,o;if(c(e.target.parentNode).removeClass("form-item-error"),r===i.length-1)return n}return n},o=e=>{let t={};return t.target=document.getElementById(e),n(t)},i=(e,t)=>{e.stopPropagation(),e.path.forEach((e=>{if(s(e.className,"select")){if(t)try{e.children[0].children[0].innerText=t,t=!1}catch(e){console.error(e)}-1!=e.className.indexOf("active")?c(e).removeClass("active"):c(e).addClass("active")}}))};let a,l=12e4,u=localStorage.vCodeTime;const m=()=>{void 0===a&&(a=setInterval((()=>{u-=1e3,u<1&&(clearInterval(a),a=void 0,u=0),c("#sendCode").addClass("disabled"),c("#sendCodeVal").text(`${chrome.i18n.getMessage("optionsVerificationCodeCountdownText1")+~~(u/1e3)+chrome.i18n.getMessage("optionsVerificationCodeCountdownText2")}`),0==~~(u/1e3)&&(c("#sendCodeVal").text(chrome.i18n.getMessage("optionsSendVerificationCodeBtn")),c("#sendCode").removeClass("disabled"),c("#login-form .send-code-tip").attr("style","opacity:1;").html(`${e.regtips?e.regtips:""}`),u=l)}),1e3))};u=void 0===u?l:(e=>{let t=e[0]-e[1];return t<l?l-t:l})([Date.now(),u]),u!==l&&(m(),localStorage.removeItem("vCodeTime"));let g=1,p=null;const v=()=>{p=setInterval((()=>{g++,c("#welcome-view .recommend-list ul").animate(.8,1,0,1,0,550*-g,0,0,0,1),c("#welcome-view .btn-list li span").removeClass("active-span"),c("#welcome-view .btn-list li").removeClass("active-li"),c("#welcome-view .btn-list li").each(((e,t)=>{t==(g-1)%4&&(c(e).children().addClass("active-span"),c(e).addClass("active-li"))})),g>4&&(g=1,clearInterval(p),v(),setTimeout((()=>{c("#welcome-view .recommend-list ul").css(" transform: translateX(-550px);transition:none")}),800))}),6e3)};v();const h=e=>{let t={value:"",status:!0},s=e.target,n=e.target.parentElement,o=c(s).getAttr("data-title"),i=c(s).getAttr("data-err-format"),a=c(s).getAttr("data-reg"),r=new RegExp(a);return s.value?a&&!r.test(s.value)?(c(n).parent().next().text(i),t.status=!1):(c(n).parent().next().text(""),t.status=!0,t.value=s.value):(c(n).parent().next().text(chrome.i18n.getMessage("optionsCenterMustInputText")+o),t.status=!1),t},f=e=>{let t={};return t.target=document.getElementById(e),h(t)};(()=>{c("#auto-open-home").on("click",(()=>{let e=c("#auto-open-home").value;if(!e)return;e=e[0];let t=e.checked;t?c("#info-view .radio-box").removeClass("conceal"):c("#info-view .radio-box").addClass("conceal"),chrome.runtime.sendMessage({cmd:"autoGuide",status:t})})),c(".input").on("input",n),c(".input").on("blur",n),c(".select-item").on("click",(e=>{if(e.stopPropagation(),s(e.target.className,"select-item-selected"))return;let t=e.target.parentNode.children;for(let e=0;e<t.length;e++){const s=t[e];c(s).removeClass("select-item-selected")}c(e.target).addClass("select-item-selected"),i(e,c(e.target).text())})),c(".select").on("click",i),c(".free-use-btn").on("click",(()=>{window.location.href="/options.html?type=active"})),c("#sendCode").on("click",(()=>{if(u!==l&&0!==u)return;let e=o("email"),t=document.getElementById("emailSuffix");if(t){if(t=t.innerHTML.trim(),t&&(0==t.length||"请选择邮箱后缀"==t))return c(".form-item.input-group.input-group-with-append").addClass("form-item-error"),c("div[data-attr-msg='optionsLoginEmailRegExpValues']").html("请选择邮箱后缀"),void c(".input-group-append").addClass("err-border");e.status&&(chrome.runtime.sendMessage({cmd:"verify",email:e.value+t,type:1},(e=>{0===e.status?d.error(e.error||chrome.i18n.getMessage("optionsGetVerificationCodeFailure")):d.success(chrome.i18n.getMessage("optionsSendVerificationCodeSuccess"))})),localStorage.vCodeTime=Date.now(),m())}})),c("#submit").on("click",(()=>{let e=o("email"),t=document.getElementById("emailSuffix");if(!t)return;t=t.innerHTML.trim();let s=o("code"),n=o("passwd");e.status&&(s.status||n.status)&&(s.status||(s.value=""),n.status||(n.value=""),c("#submit").addClass("conceal"),c("#on-login").removeClass("conceal"),chrome.runtime.sendMessage({cmd:"login",email:e.value+t,code:s.value,password:n.value},(e=>{if(console.log(e),1!==e.status)return c("#submit").removeClass("conceal"),c("#on-login").addClass("conceal"),void d.error(e.msg||chrome.i18n.getMessage("optionsLoginFailure"));window.location.href="/options.html?type=welcome&isreg="+(e.isreg?"true":"false")})))})),c("#welcome-view .btn-list li").each(((e,t)=>{c(e).on("click",(()=>{c("#welcome-view .btn-list li span").removeClass("active-span"),c("#welcome-view .btn-list li").removeClass("active-li"),c(e).children().addClass("active-span"),c(e).addClass("active-li"),g=t+1,g>4&&(g=1);let s=550*(t+1);c("#welcome-view .recommend-list ul").animate(.5,1,0,1,0,-s,0,0,0,1),clearInterval(p),v()}))})),c("#look-setting-course").on("click",(()=>{c("#course-box").removeClass("conceal")})),c("#close-course").on("click",(()=>{c("#course-box").addClass("conceal")})),c("#bottom-close-btn").on("click",(()=>{c("#course-box").addClass("conceal")})),c(".cut-login-type a").on("click",(()=>{let e=c(".cut-login-type a").text();chrome.i18n.getMessage("optionsUsePasswdLoginText")==e?(c(".cut-login-type a").text(chrome.i18n.getMessage("optionsUseCodeLoginText")),c(".code-input-box").addClass("conceal"),c(".passwd-input-box").removeClass("conceal"),c("#login-form .send-code-tip").addClass("conceal"),c(".login-btn").removeClass("login-btn-box"),document.getElementById("code").value=""):(c(".cut-login-type a").text(chrome.i18n.getMessage("optionsUsePasswdLoginText")),c(".code-input-box").removeClass("conceal"),c(".passwd-input-box").addClass("conceal"),c("#login-form .send-code-tip").removeClass("conceal"),c(".login-btn").addClass("login-btn-box"),document.getElementById("passwd").value="")})),c(".edit-pp").on("click",(()=>{c("#center-view .email-text").text(e.email),c("#center-view").removeClass("conceal"),c("#unick").attr("placeholder",e.nick),c("#center-view .center-content").removeClass("conceal"),c("#center-view .center-update-success").addClass("conceal")})),c("#close-edit-box").on("click",(()=>{c("#center-view").addClass("conceal"),c("#center-view input").each(((e,t)=>{e.value=""})),t()})),c("#center-view .header-item").each(((e,t)=>{c(e).on("click",(()=>{c("#center-view .header-item").removeClass("active-header-item"),c(e).addClass("active-header-item"),c("#center-view .header-item-bottom-line").attr("style",`transform: translateX(${120*t}px);`),c(".center-content .content-item").attr("style",`transform: translateX(${-508*t}px);`)}))})),c(".uinput").on("blur",h);let a,r=12e4,C=localStorage.upCodeTime;const w=()=>{void 0===a&&(a=setInterval((()=>{C-=1e3,C<1&&(clearInterval(a),a=void 0,C=0),c("#sendUPCode").addClass("disabled"),c("#sendUPCodeVal").text(`${chrome.i18n.getMessage("optionsVerificationCodeCountdownText1")+~~(C/1e3)+chrome.i18n.getMessage("optionsVerificationCodeCountdownText2")}`),0==~~(C/1e3)&&(c("#sendUPCodeVal").text(chrome.i18n.getMessage("optionsSendVerificationCodeBtn")),c("#sendUPCode").removeClass("disabled"),C=r)}),1e3))};C=void 0===C?r:(e=>{let t=e[0]-e[1];return t<r?r-t:r})([Date.now(),C]),C!==r&&(w(),localStorage.removeItem("upCodeTime")),c("#sendUPCode").on("click",(t=>{C!==r&&0!==C||e.email&&(chrome.runtime.sendMessage({cmd:"verify",email:e.email,type:2},(e=>{0===e.status?d.error(e.error||chrome.i18n.getMessage("optionsGetVerificationCodeFailure")):d.success(chrome.i18n.getMessage("optionsSendVerificationCodeSuccess"))})),localStorage.upCodeTime=Date.now(),w())})),c("#submitUpdatePasswd").on("click",(()=>{let t=f("uPasswordCode"),s=f("uPassword"),n=f("uRPassword");t.status&&s.status&&n.status&&e.email&&(s.value==n.value?chrome.runtime.sendMessage({cmd:"update",code:t.value,password:n.value,vemail:e.email},(e=>{1===e.status?(d.success(chrome.i18n.getMessage("optionsCenterUpdateSuccessTips")),c("#uPasswordCode").value[0].value="",c("#uPassword").value[0].value="",c("#uRPassword").value[0].value="",c("#center-view .center-content").addClass("conceal"),c("#center-view .center-update-success").removeClass("conceal")):d.error(e.msg||chrome.i18n.getMessage("optionsLoginFailure"))})):d.warning(chrome.i18n.getMessage("optionsCenterUpdateErrorTips1")))}));let x,E=12e4,b=localStorage.ueCodeTime;const R=()=>{void 0===x&&(x=setInterval((()=>{b-=1e3,b<1&&(clearInterval(x),x=void 0,b=0),c("#sendUECode").addClass("disabled"),c("#sendUECodeVal").text(`${chrome.i18n.getMessage("optionsVerificationCodeCountdownText1")+~~(b/1e3)+chrome.i18n.getMessage("optionsVerificationCodeCountdownText2")}`),0==~~(b/1e3)&&(c("#sendUECodeVal").text(chrome.i18n.getMessage("optionsSendVerificationCodeBtn")),c("#sendUECode").removeClass("disabled"),b=E)}),1e3))};b=void 0===b?E:(e=>{let t=e[0]-e[1];return t<E?E-t:E})([Date.now(),b]),b!==E&&(R(),localStorage.removeItem("ueCodeTime")),c("#sendUECode").on("click",(()=>{if(b!==E&&0!==b)return;let e=f("newEmail");if(!e.status)return;let t=c(".center-item #emailSuffix");if(!t)return;let s=t.value[0].innerHTML.trim();chrome.runtime.sendMessage({cmd:"verify",email:e.value+s,type:2},(e=>{0===e.status?d.error(e.error||chrome.i18n.getMessage("optionsGetVerificationCodeFailure")):d.success(chrome.i18n.getMessage("optionsSendVerificationCodeSuccess"))})),localStorage.ueCodeTime=Date.now(),R()})),c("#submitUpdateEmail").on("click",(()=>{let t=f("uEmailCode"),s=f("uEPassowrd"),n=f("newEmail");if(!(t.status&&s.status&&n.status&&e.email))return;let o=c(".center-item #emailSuffix");if(!o)return;let i=o.value[0].innerHTML.trim();chrome.runtime.sendMessage({cmd:"update",code:t.value,password:s.value,vemail:n.value+i,email:e.email},(t=>{1===t.status?(d.success(chrome.i18n.getMessage("optionsCenterUpdateSuccessTips")),c("#uEmailCode").value[0].value="",c("#uEPassowrd").value[0].value="",c("#newEmail").value[0].value="",chrome.runtime.sendMessage({cmd:"option"},(t=>{e=t,c("#old-email").text(e.email),c("#up-email").text(e.email),c("#center-view .center-content").addClass("conceal"),c("#center-view .center-update-success").removeClass("conceal")}))):d.error(t.msg||chrome.i18n.getMessage("optionsLoginFailure"))}))})),c("#submitUpdateInfo").on("click",(()=>{let t=f("unick");t.status&&chrome.runtime.sendMessage({cmd:"update",nick:t.value},(t=>{1===t.status?(d.success(chrome.i18n.getMessage("optionsCenterUpdateSuccessTips")),c("#unick").value[0].value="",chrome.runtime.sendMessage({cmd:"option"},(t=>{e=t,c("#unick").attr("placeholder",e.nick),c("#center-view .center-content").addClass("conceal"),c("#center-view .center-update-success").removeClass("conceal")}))):d.error(t.msg||chrome.i18n.getMessage("optionsLoginFailure"))}))}))})(),c("[data-attr-msg]").each((function(e){let t=c(e).getAttr("data-attr"),s=t.split(",");t=s[0];let n=c(e).getAttr("data-attr-msg"),o=n.split(",");n=o[0];for(let t=0;t<s.length;t++)c(e).attr(s[t],chrome.i18n.getMessage(o[t]))})),c("span[data-msg]").each((function(e){let t=c(e).parent();if(!t||!t.value[0])return;t=t.value[0];let s=c(e).parent().html(),n=s.match(/<span data-msg="\w*"><\/span>/g);for(const e of n){let t=/<span data-msg="(.+)"><\/span>/,n=e.match(t)[1],o=chrome.i18n.getMessage(n),i=RegExp(`<span data-msg="${n}"></span>`);s=s.replace(i,o)}c(e).parent().html(s)}))})),window.oncontextmenu=e=>{e.preventDefault()}})();